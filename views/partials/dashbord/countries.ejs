<div id="dashbord-country" class="card shadow rounded-4 p-4 mb-3">
    <h4 class="mb-3">Lista de Países</h4>

    <!-- Search + Filter -->
    <form method="GET" class="row g-2 mb-3">
        <div class="col-md-5">
            <input 
                type="text" 
                name="search"
                value="<%= search %>"
                class="form-control" 
                placeholder="Pesquisar país..." 
            />
        </div>

        <div class="col-md-3">
            <select class="form-select" name="continent">
                <option value="">Todos os continentes</option>
                <% continents.forEach(c => { %>
                    <option value="<%= c.id %>" <%= c.id == continentSelected ? "selected" : "" %>>
                        <%= c.nome %>
                    </option>
                <% }) %>
            </select>
        </div>

        <div class="col-md-3">
            <select class="form-select" name="orderBy">
                <option value="nome" <%= orderBy === "nome" ? "selected" : "" %>>Nome</option>
                <option value="populacao" <%= orderBy === "populacao" ? "selected" : "" %>>População</option>
                <option value="idioma" <%= orderBy === "idioma" ? "selected" : "" %>>Idioma oficial</option>
                <option value="moeda" <%= orderBy === "moeda" ? "selected" : "" %>>Moeda</option>
                <option value="continente" <%= orderBy === "continente" ? "selected" : "" %>>Continente</option>
            </select>
        </div>

        <div class="col-md-1">
            <button class="btn btn-primary w-100">Buscar</button>
        </div>
    </form>

    <!-- Table -->
    <table class="table table-hover">
        <thead>
            <tr>
                <th>País</th>
                <th>Continente</th>
            </tr>
        </thead>

        <tbody>
            <% if (countries.length === 0) { %>
                <tr>
                    <td colspan="2" class="text-center text-muted">Nenhum país encontrado.</td>
                </tr>
            <% } %>

            <% countries.forEach(p => { %>
            <tr data-bs-toggle="modal" data-bs-target="#modalPais<%= p.id %>">
                <td><%= p.nome %></td>
                <td><%= p.continente %></td>
            </tr>
            <% }) %>
        </tbody>
    </table>

    <!-- Pagination -->
    <nav>
        <ul class="pagination justify-content-center">
            <% if (currentPage > 1) { %>
                <li class="page-item">
                    <a class="page-link text-secondary" href="?countryPage=<%= currentPage - 1 %>&search=<%= search %>&continent=<%= continentSelected %>&orderBy=<%= orderBy %>">
                        &laquo;
                    </a>
                </li>
            <% } %>

            <% for (let i = 1; i <= totalPages; i++) { %>
                <li class="page-item <%= i === currentPage ? 'active' : '' %>">
                    <a class="page-link" href="?countryPage=<%= i %>&search=<%= search %>&continent=<%= continentSelected %>&orderBy=<%= orderBy %>">
                        <%= i %>
                    </a>
                </li>
            <% } %>

            <% if (currentPage < totalPages) { %>
                <li class="page-item">
                    <a class="page-link text-secondary" href="?countryPage=<%= currentPage + 1 %>&search=<%= search %>&continent=<%= continentSelected %>&orderBy=<%= orderBy %>">
                        &raquo;
                    </a>
                </li>
            <% } %>
        </ul>
    </nav>
</div>

<!-- Modal Dinâmico -->
<% countries.forEach(p => { %>
<div class="modal fade" id="modalPais<%= p.id %>" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><%= p.nome %></h5>
                <button class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p><strong>População:</strong> <%= p.populacao.toLocaleString() %></p>
                <p><strong>Idioma oficial:</strong> <%= p.idioma_oficial %></p>
                <p><strong>Moeda:</strong> <%= p.moeda %></p>
                <p><strong>Continente:</strong> <%= p.continente %></p>
            </div>
        </div>
    </div>
</div>
<% }) %>