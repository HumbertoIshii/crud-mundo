<div id="dashbord-city" class="card shadow rounded-4 p-4 mb-3">
    <h4 class="mb-3">Lista de Cidades</h4>

    <form method="GET" class="row g-2 mb-3">
        <div class="col-md-5">
            <input 
                type="text" 
                name="citySearch"
                value="<%= citySearch %>"
                class="form-control" 
                placeholder="Pesquisar cidade..." 
            />
        </div>
        <div class="col-md-3">
            <input 
                type="text" 
                name="cityCountryContinent"
                value="<%= cityCountryContinent %>"
                class="form-control" 
                placeholder="País ou Continente" 
            />
        </div>
        <div class="col-md-3">
            <select class="form-select" name="cityOrderBy">
                <option value="nome" <%= cityOrderBy === "nome" ? "selected" : "" %>>Nome</option>
                <option value="populacao" <%= cityOrderBy === "populacao" ? "selected" : "" %>>População</option>
                <option value="latitude" <%= cityOrderBy === "latitude" ? "selected" : "" %>>Latitude</option>
                <option value="longitude" <%= cityOrderBy === "longitude" ? "selected" : "" %>>Longitude</option>
                <option value="pais" <%= cityOrderBy === "pais" ? "selected" : "" %>>País</option>
                <option value="continente" <%= cityOrderBy === "continente" ? "selected" : "" %>>Continente</option>
            </select>
        </div>
        <div class="col-md-1">
            <button class="btn btn-primary w-100">Buscar</button>
        </div>
    </form>

    <table class="table table-hover">
        <thead>
            <tr>
                <th>Cidade</th>
                <th>País</th>
                <th>Continente</th>
            </tr>
        </thead>
        <tbody>
            <% if (cities.length === 0) { %>
                <tr>
                    <td colspan="3" class="text-center text-muted">Nenhuma cidade encontrada.</td>
                </tr>
            <% } %>

            <% cities.forEach(ci => { %>
            <tr data-bs-toggle="modal" data-bs-target="#modalCity<%= ci.id %>">
                <td><%= ci.nome %></td>
                <td><%= ci.pais %></td>
                <td><%= ci.continente %></td>
            </tr>
            <% }) %>
        </tbody>
    </table>

    <nav>
        <ul class="pagination justify-content-center">
            <% if (cityCurrentPage > 1) { %>
                <li class="page-item">
                    <a class="page-link text-secondary" href="?cityPage=<%= cityCurrentPage - 1 %>&citySearch=<%= citySearch %>&cityCountryContinent=<%= cityCountryContinent %>&cityOrderBy=<%= cityOrderBy %>">
                        &laquo;
                    </a>
                </li>
            <% } %>

            <% for (let i = 1; i <= cityTotalPages; i++) { %>
                <li class="page-item <%= i === cityCurrentPage ? 'active' : '' %>">
                    <a class="page-link" href="?cityPage=<%= i %>&citySearch=<%= citySearch %>&cityCountryContinent=<%= cityCountryContinent %>&cityOrderBy=<%= cityOrderBy %>">
                        <%= i %>
                    </a>
                </li>
            <% } %>

            <% if (cityCurrentPage < cityTotalPages) { %>
                <li class="page-item">
                    <a class="page-link text-secondary" href="?cityPage=<%= cityCurrentPage + 1 %>&citySearch=<%= citySearch %>&cityCountryContinent=<%= cityCountryContinent %>&cityOrderBy=<%= cityOrderBy %>">
                        &raquo;
                    </a>
                </li>
            <% } %>
        </ul>
    </nav>
</div>

<% cities.forEach(ci => { %>
<div class="modal fade" id="modalCity<%= ci.id %>" tabindex="-1">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title"><%= ci.nome %></h5>
                <button class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <p><strong>População:</strong> <%= ci.populacao.toLocaleString() %></p>
                <p><strong>Latitude:</strong> <%= ci.latitude %></p>
                <p><strong>Longitude:</strong> <%= ci.longitude %></p>
                <p><strong>País:</strong> <%= ci.pais %></p>
                <p><strong>Continente:</strong> <%= ci.continente %></p>
            </div>
        </div>
    </div>
</div>
<% }) %>